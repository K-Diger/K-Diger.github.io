---

title: 토비의 스프링 8장
author: 김도현
date: 2023-05-03
categories: [Spring, Toby]
tags: [Spring, Toby]
math: true
mermaid: true

---

# 스프링이란?

스프링은 `자바 엔터프라이즈 개발을 편하게 해주는 오픈소스 경량급 애플리케이션 프레임워크` 이라고 한다.

이 정의를 조금씩 분해해서 살펴보자

## 애플리케이션 프레임워크

애플리케이션 프레임워크는 특정 계층/기술/분야에 관계없이 애플리케이션 전 영역을 다루는 범용 프레임워크이다.

이게 일반 프레임워크랑 무슨 차이냐면, 일반적으로 프레임워크/라이브러리 라고 불리는 것은 특정 한 계층에서 동작하는 기술 분야를 가리킨다.

### 스프링이 애플리케이션 프레임워크가 된 이유

스프링의 기원은 J2EE 애플리케이션 설계와 개발 전략을 다루는 책에서 시작했는데

`항상 프레임워크 기반으로 접근하라`는 전략을 강조했고, 이 책의 예제 애플리케이션을 만드는 과정에서 프레임워크를 먼저 만든 후 그 프레임워크를 이용하는 코드를 작성하는 방식으로 되어있다.

이때 만들어진 프레임워크가 스프링이 되었다.

이 프레임워크는 자바 엔터프라이즈 개발 전략의 핵심을 담고 있고 모든 계층에 등장하는 기술을 효과적으로 다룰 수 있게 해준다.

여기서 계층이란 JDBC/ORM 지원 IoC/DI 등 우리가 알고 있는 스프링의 핵심 기술들을 모두 가리킨다.

---

## 경량급

스프링 자체는 가볍지 않다. 그러나 불필요하게 무겁지 않다.

스프링 이전에 사용했던 EJB는 과한 엔지니어링이 적용되어있어 개발/빌드/테스트 등 모든 코드를 무겁게 만들었다.

스프링은 그 코드 자체도 경량화 되어있을 뿐 아니라 EJB에서 사용하던 별도의 무거운 WAS를 장착하지 않아도 된다는 점이 경량급이라는 것이다.


---

## 자바 엔터프라이즈 개발을 편하게

스프링은 자바 엔터프라이즈 개발에 있어서 그 근본적인 문제/복잡합을 해결한다.

개발을 편하게 할 수 있다는 것은, 로우 레벨에 위치한 기술을 직접 다루지 않아도 엔터프라이즈를 만들 수 있다는 것이다.

EJB가 탄생했을 때도 이와 같은 문구를 장착했지만 서로 문제를 해결하는 초점이 달랐다.

---

## 오픈소스

스프링은 오픈소스이다. 따라서 라이선스 비용을 지불하지 언제든지 상업적 용도로도 사용할 수 있다.

오픈소스라고 한다면 사이드 프로젝트로 진행한 뉘양스도 있어서 굉장히 불안정한 느낌이 있지만

스프링은 스프링소스 라는 기업에서 진행하는 프로젝트이므로 무료로 안정적으로 기능을 제공하는 프레임워크인 것이다.

---

# 스프링의 개발 철학과 궁극적인 목표는?

`엔터프라이즈 개발을 편하게 하는 것` 이것이 목표다. 그러면 엔터프라이즈 개발은 어떤 점이 불편할까?

### 기술적인 제약, 요구사항 확장

엔터프라이즈를 개발한다는 것은 순수 비즈니스 로직을 구현하는 것 뿐만 아니라 이것저것 신경써야할게 굉장히 많다.

사용자 인터페이스, 타 시스템과의 통신 등 이런 내용들을 다 신경쓰고, 기능 확장에도 열어두어야한다는 점이 불편하다.

### 비즈니스 로직의 복잡성 증가

이전과 다르게 엔터프라이즈 서비스의 수요가 늘어나면서 요구사항도 늘어나게 되고, 이전과 다르게 유지보수/추가 개발의 필요성이 점점 커지고 있다.

## 기술적인 복잡함, 비즈니스 로직의 복잡함을 분리해야한다.

이 두 문제를 해결하기 위해 EJB가 등장했지만, 그 자체적인 특징에 크게 결합되게 만들어버려 실패한 프로젝트가 되었다.

예를들어, 특정 EJB클래스를 상속받아야지만 트랜잭션을 처리할 수 있는 등 자바가 제공하는 다향성을 제한하여 객체지향적인 특성을 지우고 있었다.

## 스프링은 EJB를 교훈 삼아 비침투적이다.

스프링은 EJB처럼 코드에 직접적으로 종속되어 자체적인 복잡성을 증가시키는 것을 지양한다.

따라서 기술적인 복잡함과 비즈니스 로직을 분리할 수 있게 되었다. 그러면 어떻게 분리하는 해결책을 제시한 것일까?

---

# 스프링 복잡함을 어떻게 해결한 걸까?

스프링은 엔터프라이즈 기술을 적용했을 때 발생하는 복잡한 문제는 두 가지로 정의하고 해결한다.

### 기술에 대한 접근 방식의 일관성이 없고, 환경에 종속적이다.

환경에 따라 API를 사용하는 방법이 달라진다는 것은 큰 문제이다.

스프링은 지금까지 살펴봐온 트랜잭션 추상화, 메일 서비스 추상화 등 `서비스 추상화`를 적용하여 이 문제를 해결하고자 한다.

스프링은 이 때 템플릿/콜백 패턴을 제공하여 반복적인 작업흐름, API사용 흐름을 제거한다.

결론적으로 서비스 추상화 기법으로 어떤 환경이나 외부적 요소에 종속되지 않고 비즈니스 로직에 집중할 수 있게 해준다.

### 기술적 처리를 담당하는 코드가 성격이 다른 코드에 섞인다.

비즈니스 로직 전후로 경계가 설정돼야하는 트랜잭션, 비즈니스 로직 처리 간의 로깅 등 어떤 요구사항 하나를 처리할 때 수행하는

여러 기술이 한 로직에 섞여있으면 골치아프다.

스프링은 `AOP`라는 기술을 활용해 이 문제도 해결한다. 비즈니스 로직과 부가적인 로직이 섞여있지않기 때문에 그 로직 자체에 집중할 수 있고

중복되는 부가기능을 일일히 만들지 않아도 된다.

---

여차저차 스프링이 제공하는 좋은 전략들을 바탕으로 비즈니스 로직만 신경쓰면 된다는 점을 알았다.

그러면 비즈니스 로직을 더 용이하게 작성할 수 있는 전략들은 제공하는건 뭐가 있을까?

# 비즈니스 로직을 좀 더 쉽게 만들어봅시다. (DI)

스프링은 Java라는 언어의 객체지향의 특징을 살려서 객체지향 분석과 설계(OOAD)를 작성하는 좋은 도구를 사용한다.

## DI

지금까지 살펴온 기술적인 복잡함을 다룰 수 있게 해주는 기법은 DI가 중심에 있었다.

`서비스 추상화, 템플릿/콜백, AOP`는 모두 DI가 적용된 기술들인 것이다.

사실 DI는 특별한 기술이 아닌, 객체지향을 적용하다보면 자연스럽게 갖춰지는 결과물이기도 하지만

DI를 잘 적용하다 보면 좋은 객체지향의 설계와 원칙을 지키게 된다.

스프링을 사용하면서 제공받는 기술과 전략을 객체지향 언어인 Java가 가진 특징을 극대화 하는 것이다.

객체지향적으로만 잘 비즈니스로직을 만들어두면 그 외의 일들은 스프링이 대신하여 좋은 코드를 작성할 수 있게 도와준다는 것이다.

---

# POJO

스프링 개발자들이 작성한 Professional Spring Framework라는 책에서 말하길

`스프링은 POJO에 엔터프라이즈 서비스 기능을 제공하는 것` 이라고 한다.

즉, 엔터프라이즈 서비스 기능은 스프링이 제공하며 이를 사용하는 개발자들은 POJO를 이쁘게 사용하기만 하면 된다는 것이다.

![img_2.png](images/toby8/img_2.png)

스프링의 기본구조는 위 그림으로 표현할 수 있다.

POJO를 이용해서 만든 코드를 기반으로하여 그 POJO코드가 어떻게 관계를 맺고 동작하는지를 나타낸다.

DI의 기본 개념은 유연하게 확장 가능한 객체를 만든 후 그 관계는 외부에서 설정해준다는 것이 있다.

이 DI의 개념을 애플리케이션 전반적으로 적용한 것이 스프링의 모델이다.

## 그렇다면 POJO는 무엇인가?

`Plain Old Java Object`의 약어로 그냥 자바 객체라고도 생각할 순 있지만 통상적으로 몇 가지의 규칙을 지닌 것들을 가리킨다.

### POJO의 조건 1. 특정 규약에 종속되지 않는다.

자바 언어와 꼭 필요한 API 외에는 종속되지 않아야한다.

특히 스프링 이전에 사용되었던 EJB같은 경우 특정 클래스를 상속 받도록 하기 때문에 유연성이 크게 저하된다.

이렇게 된다면 객체지향적인 내용을 담기가 어렵고 그 특정 클래스에 크게 종속되기 때문에 진짜 별로다.

### POJO의 조건 2. 특정 환경에 종속되지 않는다.

말 그대로 특정 서버나 프레임워크에 의존하지 않아야한다. 순수한 애플리케이션 로직을 담고 있는 객체가 다른 환경에 종속적이면 안된다.

특히 비즈니스 로직을 담고 있는 POJO는 웹 환경정보, 웹 기술에 관한 클래스/인터페이스에 종속적이지 않아야 한다는 점이 중요하다.

비즈니스 로직이 있는 코드에 HttpServletRequest등 이런 내용을 굳이 쓰지 말라고 하는 것이다.

### POJO의 불문율

특정 기술과 환경에 종속되지 않고 Java API만 썼다고해서 POJO가 아니다.

POJO는 객체지향적인 자바 언어의 기본에 충실하게 만들어져야한다.

`재사용성`, `환경과 기술에 종속되지 않음`, `재활용이 될 수 있는 여지` 이 요소가 모두 담겨있어야 진정한 POJO라고 부를 수 있고

이 POJO를 활용하여 애플리케이션의 비즈니스 로직을 처리하고 개발하는 것을 POJO 프로그래밍이라고 한다.

## POJO의 장점

POJO가 될 수 있는 조건 그 자체가 장점이다.

- 특정 기술과 환경에 종속되지 않아 깔끔한 코드가 될 수 있고 자동화된 테스트에 매우 유리한 장점을 지녔다.

- 객체지향적인 설계를 자유롭게 적용할 수 있다. 그리고 도메인 모델, 디자인 패턴 등을 적용하기에는 POJO방식이 훨씬 유리하기도 하다.

지금까지 이야기 해온 내용들이 객체지향으로 이어지는 것 같은데, 객체지향 프로그래밍은 지금까지 등장한 프로그래밍 방식 중

가장 효과적으로 복잡한 엔터프라이즈에서 문제를 해결할 수 있다는 방식으로 증명이 되었다.

## POJO 프레임워크

스프링 프레임워크, 하이버네이트는 대표적인 POJO 프레임워크이다.

스프링 프레임워크는 엔터프라이즈 애플리케이션 모든 영역과 계층에서 POJO 방식으로 구현할 수 있도록 만들어졌으며

하이버네이트는 DB 접근 기술에 POJO를 적용할 수 있도록 만들어졌다.

![img_3.png](images/toby8/img_3.png)

위 그림처럼 스프링은 `비즈니스 로직의 복잡함`과 `엔터프라이즈 기술의 복잡함`을 분리하여 구성하게 한다.

비즈니스 로직의 복잡함은 POJO 객체들끼리 해결할 수 있도록 하고 엔터프라이즈 기술적인 복잡함은 스프링이 알아서 해결해준다.

결론적으로 스프링은 객체지향적인 설계와 개발의 원리에 더 집중할 수 있도록 기회를 마련해주는 것이다.

---

# 스프링의 기술

스프링은 그 어려운 엔터프라이즈 기술의 복잡함을 해결을 담당하고

비즈니스 로직의 복잡함을 POJO로 해결할 수 있도록 제공하는 `세 가지 가능기술`이 있는데 그 기술이 IoC/DI, AOP, PSA이다.

## Ioc/DI

스프링의 가장 기본이 되는 기술이자 핵심 개발 원칙이다. AOP와 PSA도 이 기술을 바탕으로 두고 있다.

그리고 책 초반에서 살펴본 템플릿/콜백 패턴이 적용된 부분도 이 IoC/DI가 핵심이였다.

IoC/DI는 객체를 분리하고 인터페이스를 통해 느슨하게 연결한 후 외부에서 DI를 하는 방식을 가리킨다.

`그런데 왜 굳이 객체를 분리하고 외부에서 주입받는걸까?`

이렇게 하는 방식이 유연한 확장이 가능하게 하기 때문이다. 그리고 DI라는 방법론은 OCP라는 객체지향 설계 원칙으로 설명할 수 있다.

A -> B 라는 의존관계를 갖는 구조가 있을 때 B는 자유롭게 확장할 수 있다. 즉, B가 변경되어도 A는 아무런 영향을 받지 않는다는 의미이다.

이 현상은 B관점에서 유연하게 확장할 수 있음을 가리키고 A관점에서는 변경없이 재사용이 가능하다고 볼 수 있는 것이다.

### DI의 활용 방법

